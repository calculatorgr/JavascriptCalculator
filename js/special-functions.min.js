/*MIT License Copyright Â© 2017-2023 Paul Masson, https://github.com/paulmasson/math/blob/master/LICENSE.md*/var pi=Math.PI;function complex(e,r){return{re:e,im:r=r||0}}var C=complex;function isComplex(e){return"object"==typeof e&&"re"in e}function abs(e){return isComplex(e)?0===e.re&&0===e.im?0:Math.abs(e.re)<Math.abs(e.im)?Math.abs(e.im)*Math.sqrt(1+(e.re/e.im)**2):Math.abs(e.re)*Math.sqrt(1+(e.im/e.re)**2):Math.abs(e)}function arg(e){return isComplex(e)?Math.atan2(e.im,e.re):Math.atan2(0,e)}function add(e,r){if(arguments.length>2){for(var i=add(e,r),a=2;a<arguments.length;a++)i=add(i,arguments[a]);return i}return isComplex(e)||isComplex(r)?(isComplex(e)||(e=complex(e)),isComplex(r)||(r=complex(r)),{re:e.re+r.re,im:e.im+r.im}):e+r}function sub(e,r){return isComplex(e)||isComplex(r)?(isComplex(e)||(e=complex(e)),isComplex(r)||(r=complex(r)),{re:e.re-r.re,im:e.im-r.im}):e-r}function mul(e,r){if(arguments.length>2){for(var i=mul(e,r),a=2;a<arguments.length;a++)i=mul(i,arguments[a]);return i}return isComplex(e)||isComplex(r)?(isComplex(e)||(e=complex(e)),isComplex(r)||(r=complex(r)),{re:e.re*r.re-e.im*r.im,im:e.im*r.re+e.re*r.im}):e*r}function neg(e){return mul(-1,e)}function div(e,r){if(isComplex(e)||isComplex(r)){if(isComplex(e)||(e=complex(e)),isComplex(r)||(r=complex(r)),Math.abs(r.re)<Math.abs(r.im)){var i=r.re/r.im;return{re:(e.re*i+e.im)/(r.re*i+r.im),im:(e.im*i-e.re)/(r.re*i+r.im)}}i=r.im/r.re;return{re:(e.re+e.im*i)/(r.re+r.im*i),im:(e.im-e.re*i)/(r.re+r.im*i)}}return e/r}function inv(e){return div(1,e)}function pow(e,r){if(isComplex(e)||isComplex(r)){if(isComplex(e)||(e=complex(e)),isComplex(r)||(r=complex(r)),0===e.re&&0===e.im&&r.re>0)return complex(0);if(0===e.re&&0===e.im&&0===r.re&&0===r.im)return complex(1);if(0===e.re&&0===e.im&&r.re<0)throw"Power singularity";var i=Math.sqrt(e.re*e.re+e.im*e.im),a=Math.atan2(e.im,e.re),t=i**r.re*Math.exp(-a*r.im),o=a*r.re+r.im*Math.log(i);return{re:t*Math.cos(o),im:t*Math.sin(o)}}return e<0?pow(complex(e),r):e**r}function root(e,r){return pow(e,div(1,r))}function sqrt(e){if(isComplex(e)){var r=(e.re*e.re+e.im*e.im)**.25,i=Math.atan2(e.im,e.re)/2;return{re:r*Math.cos(i),im:r*Math.sin(i)}}return e<0?sqrt(complex(e)):Math.sqrt(e)}function besselJ(e,r){return isComplex(e)||isComplex(r)?(isComplex(e)||(e=complex(e)),isComplex(r)||(r=complex(r)),Number.isInteger(e.re)&&e.re<0&&0===e.im?mul(pow(-1,e),besselJ(mul(-1,e),r)):mul(div(pow(div(r,2),e),gamma(add(e,1))),hypergeometric0F1(add(e,1),mul(-.25,pow(r,2))))):Number.isInteger(e)&&e<0?(-1)**e*besselJ(-e,r):!Number.isInteger(e)&&r<0?besselJ(e,complex(r)):(r/2)**e*hypergeometric0F1(e+1,-.25*r**2)/gamma(e+1)}function besselY(e,r){return isComplex(e)||isComplex(r)?(isComplex(e)||(e=complex(e)),isComplex(r)||(r=complex(r)),Number.isInteger(e.re)&&0===e.im?div(add(besselY(e.re+1e-5,r),besselY(e.re-1e-5,r)),2):div(sub(mul(besselJ(e,r),cos(mul(e,pi))),besselJ(mul(-1,e),r)),sin(mul(e,pi)))):r<0?besselY(e,complex(r)):Number.isInteger(e)?(besselY(e+1e-5,r)+besselY(e-1e-5,r))/2:(besselJ(e,r)*cos(e*pi)-besselJ(-e,r))/sin(e*pi)}function besselI(e,r){return isComplex(e)||isComplex(r)?(isComplex(e)||(e=complex(e)),isComplex(r)||(r=complex(r)),Number.isInteger(e.re)&&e.re<0&&0===e.im?besselI(mul(-1,e),r):mul(div(pow(div(r,2),e),gamma(add(e,1))),hypergeometric0F1(add(e,1),mul(.25,pow(r,2))))):Number.isInteger(e)&&e<0?besselI(-e,r):!Number.isInteger(e)&&r<0?besselI(e,complex(r)):(r/2)**e*hypergeometric0F1(e+1,.25*r**2)/gamma(e+1)}function besselK(e,r){return isComplex(e)||isComplex(r)?(isComplex(e)||(e=complex(e)),isComplex(r)||(r=complex(r)),abs(r)>5?mul(mul(sqrt(div(pi/2,r)),exp(mul(-1,r))),hypergeometric2F0(add(e,.5),sub(.5,e),div(-1,mul(2,r)))):Number.isInteger(e.re)&&0===e.im?div(add(besselK(e.re+1e-5,r),besselK(e.re-1e-5,r)),2):mul(div(pi/2,sin(mul(e,pi))),sub(besselI(mul(-1,e),r),besselI(e,r)))):r>5?sqrt(pi/2/r)*exp(-r)*hypergeometric2F0(e+.5,.5-e,-.5/r):r<0?besselK(e,complex(r)):Number.isInteger(e)?(besselK(e+1e-5,r)+besselK(e-1e-5,r))/2:pi/2*(besselI(-e,r)-besselI(e,r))/sin(e*pi)}function hankel1(e,r){return add(besselJ(e,r),mul(complex(0,1),besselY(e,r)))}function hankel2(e,r){return sub(besselJ(e,r),mul(complex(0,1),besselY(e,r)))}function airyAi(e){return isComplex(e)?mul(1/pi,mul(sqrt(div(e,3)),besselK(1/3,mul(2/3,pow(e,1.5))))):0===e?1/3**(2/3)/gamma(2/3):e<0?sqrt(-e)/2*(besselJ(1/3,2/3*(-e)**1.5)-besselY(1/3,2/3*(-e)**1.5)/sqrt(3)):1/pi*sqrt(e/3)*besselK(1/3,2/3*e**1.5)}function airyBi(e){return isComplex(e)?mul(sqrt(div(e,3)),add(besselI(1/3,mul(2/3,pow(e,1.5))),besselI(-1/3,mul(2/3,pow(e,1.5))))):0===e?1/3**(1/6)/gamma(2/3):e<0?-sqrt(-e)/2*(besselJ(1/3,2/3*(-e)**1.5)/sqrt(3)+besselY(1/3,2/3*(-e)**1.5)):sqrt(e/3)*(besselI(1/3,2/3*e**1.5)+besselI(-1/3,2/3*e**1.5))}function sphericalBesselJ(e,r){return mul(sqrt(div(pi/2,r)),besselJ(add(e,.5),r))}function sphericalBesselY(e,r){return mul(sqrt(div(pi/2,r)),besselY(add(e,.5),r))}function sphericalHankel1(e,r){return add(sphericalBesselJ(e,r),mul(complex(0,1),sphericalBesselY(e,r)))}function sphericalHankel2(e,r){return sub(sphericalBesselJ(e,r),mul(complex(0,1),sphericalBesselY(e,r)))}function jacobiTheta(e,r,i,a=1e-10){if(abs(i)>=1)throw"Unsupported elliptic nome";if(![1,2,3,4].includes(e))throw"Undefined Jacobi theta index";if(isComplex(r)||isComplex(i)){isComplex(r)||(r=complex(r));var t=div(log(i),complex(0,1));if(Math.abs(r.im)>Math.abs(t.im)||Math.abs(r.re)>Math.PI){var o=Math.round(r.im/t.im);r=sub(r=sub(r,mul(o,t)),(m=Math.round(r.re/Math.PI))*Math.PI);var n=pow(i,-o*o),s=exp(mul(-2*o,r,complex(0,1)));switch(e){case 1:return mul((-1)**(m+o),n,s,chop(jacobiTheta(e,r,i),a));case 2:return mul((-1)**m,n,s,chop(jacobiTheta(e,r,i),a));case 3:return mul(n,s,chop(jacobiTheta(e,r,i),a));case 4:return mul((-1)**o,n,s,chop(jacobiTheta(e,r,i),a))}}switch(e){case 1:for(var l=complex(0),m=complex(1),u=0;Math.abs(m.re)>a||Math.abs(m.im)>a;)l=add(l,m=mul((-1)**u,pow(i,u*u+u),sin(mul(2*u+1,r)))),u++;return mul(2,pow(i,.25),l);case 2:for(l=complex(0),m=complex(1),u=0;Math.abs(m.re)>a||Math.abs(m.im)>a;)l=add(l,m=mul(pow(i,u*u+u),cos(mul(2*u+1,r)))),u++;return mul(2,pow(i,.25),l);case 3:for(l=complex(0),m=complex(1),u=1;Math.abs(m.re)>a||Math.abs(m.im)>a;)l=add(l,m=mul(pow(i,u*u),cos(mul(2*u,r)))),u++;return add(1,mul(2,l));case 4:for(l=complex(0),m=complex(1),u=1;Math.abs(m.re)>a||Math.abs(m.im)>a;)l=add(l,m=mul(pow(neg(i),u*u),cos(mul(2*u,r)))),u++;return add(1,mul(2,l))}}if(Math.abs(r.re)>Math.PI)switch(r-=(m=Math.round(r/Math.PI))*Math.PI,e){case 1:case 2:return(-1)**m*jacobiTheta(e,r,i);case 3:case 4:return jacobiTheta(e,r,i)}switch(e){case 1:if(i<0)return jacobiTheta(e,r,complex(i));for(l=0,m=1,u=0;Math.abs(m)>a;)l+=m=(-1)**u*i**(u*u+u)*sin((2*u+1)*r),u++;return 2*i**.25*l;case 2:if(i<0)return jacobiTheta(e,r,complex(i));for(l=0,m=1,u=0;Math.abs(m)>a;)l+=m=i**(u*u+u)*cos((2*u+1)*r),u++;return 2*i**.25*l;case 3:for(l=0,m=1,u=1;Math.abs(m)>a;)l+=m=i**(u*u)*cos(2*u*r),u++;return 1+2*l;case 4:for(l=0,m=1,u=1;Math.abs(m)>a;)l+=m=(-i)**(u*u)*cos(2*u*r),u++;return 1+2*l}}function ellipticNome(e){return isComplex(e)?exp(div(mul(-pi,ellipticK(sub(1,e))),ellipticK(e))):e>1?ellipticNome(complex(e)):e<0?-exp(-pi*ellipticK(1/(1-e))/ellipticK(e/(e-1))):exp(-pi*ellipticK(1-e)/ellipticK(e))}function sn(e,r){var i=ellipticNome(r);if(r>1||isComplex(e)||isComplex(r)){var a=div(e,pow(jacobiTheta(3,0,i),2));return mul(div(jacobiTheta(3,0,i),jacobiTheta(2,0,i)),div(jacobiTheta(1,a,i),jacobiTheta(4,a,i)))}a=e/jacobiTheta(3,0,i)**2;return r<0?jacobiTheta(3,0,i)/jacobiTheta(4,a,i)*div(jacobiTheta(1,a,i),jacobiTheta(2,0,i)).re:jacobiTheta(3,0,i)/jacobiTheta(2,0,i)*jacobiTheta(1,a,i)/jacobiTheta(4,a,i)}function cn(e,r){var i=ellipticNome(r);if(r>1||isComplex(e)||isComplex(r)){var a=div(e,pow(jacobiTheta(3,0,i),2));return mul(div(jacobiTheta(4,0,i),jacobiTheta(2,0,i)),div(jacobiTheta(2,a,i),jacobiTheta(4,a,i)))}a=e/jacobiTheta(3,0,i)**2;return r<0?jacobiTheta(4,0,i)/jacobiTheta(4,a,i)*div(jacobiTheta(2,a,i),jacobiTheta(2,0,i)).re:jacobiTheta(4,0,i)/jacobiTheta(2,0,i)*jacobiTheta(2,a,i)/jacobiTheta(4,a,i)}function dn(e,r){var i=ellipticNome(r);if(r>1||isComplex(e)||isComplex(r)){var a=div(e,pow(jacobiTheta(3,0,i),2));return mul(div(jacobiTheta(4,0,i),jacobiTheta(3,0,i)),div(jacobiTheta(3,a,i),jacobiTheta(4,a,i)))}a=e/jacobiTheta(3,0,i)**2;return jacobiTheta(4,0,i)/jacobiTheta(3,0,i)*jacobiTheta(3,a,i)/jacobiTheta(4,a,i)}function am(e,r){if(r>1||isComplex(e)||isComplex(r)){if(isComplex(e)||(e=complex(e)),isComplex(r)||(r=complex(r)),0===r.im&&r.re<=1){var i=ellipticK(r.re);if(e=sub(e,2*(t=Math.round(e.re/2/i))*i),r.re<0){var a=ellipticK(1-r.re);if(1&Math.round(e.im/2/a.re))return sub(t*pi,arcsin(sn(e,r)))}return add(arcsin(sn(e,r)),t*pi)}return arcsin(sn(e,r))}var t;i=ellipticK(r);return e-=2*(t=Math.round(e/2/i))*i,Math.asin(sn(e,r))+t*pi}function carlsonRC(e,r){return e<0||r<0||isComplex(e)||isComplex(r)?(isComplex(e)||(e=complex(e)),isComplex(r)||(r=complex(r)),e.re===r.re&&e.im===r.im?inv(sqrt(e)):div(arccos(sqrt(div(e,r))),sqrt(sub(r,e)))):e===r?1/Math.sqrt(e):e<r?Math.acos(Math.sqrt(e/r))/Math.sqrt(r-e):Math.acosh(Math.sqrt(e/r))/Math.sqrt(e-r)}function carlsonRD(e,r,i){return carlsonRJ(e,r,i,i)}function carlsonRF(e,r,i,a=1e-10){if(isComplex(e)||isComplex(r)||isComplex(i)){for(var t=e,o=r,n=i,s=A0=div(add(e,r,i),3),l=Math.pow(3*a,-1/6)*Math.max(abs(sub(A0,e)),abs(sub(A0,r)),abs(sub(A0,i))),m=.25,u=1;;){var c=sqrt(t),p=sqrt(o),h=sqrt(n),f=mul(add(s,M=add(mul(c,p),mul(c,h),mul(p,h))),m);if(t=mul(add(t,M),m),o=mul(add(o,M),m),n=mul(add(n,M),m),u*l<abs(s))break;s=f,1,u*=m}var d=div(u,s),b=neg(add(g=mul(sub(A0,e),d),C=mul(sub(A0,r),d))),x=sub(mul(g,C),mul(b,b)),v=mul(g,C,b);return mul(pow(s,-.5),add(9240,mul(-924,x),mul(385,x,x),mul(660,v),mul(-630,x,v)),1/9240)}if(r===i)return carlsonRC(e,r);if(e===i)return carlsonRC(r,e);if(e===r)return carlsonRC(i,e);for(t=e,o=r,n=i,s=A0=(e+r+i)/3,l=Math.pow(3*a,-1/6)*Math.max(Math.abs(A0-e),Math.abs(A0-r),Math.abs(A0-i)),m=.25,u=1;;){var M;f=(s+(M=(c=Math.sqrt(t))*(p=Math.sqrt(o))+c*(h=Math.sqrt(n))+p*h))*m;if(t=(t+M)*m,o=(o+M)*m,n=(n+M)*m,u*l<Math.abs(s))break;s=f,1,u*=m}var g,C;d=u/s,x=(g=(A0-e)*d)*(C=(A0-r)*d)-(b=-g-C)**2,v=g*C*b;return Math.pow(s,-.5)*(9240-924*x+385*x**2+660*v-630*x*v)/9240}function carlsonRG(e,r,i){return 1}function carlsonRJ(e,r,i,a,t=1e-10){if(isComplex(e)||isComplex(r)||isComplex(i)||isComplex(a)){for(var o=e,n=r,s=i,l=a,m=Am=div(add(e,r,i,mul(2,a)),5),u=mul(sub(a,e),sub(a,r),sub(a,i)),c=Math.pow(.25*t,-1/6)*Math.max(abs(sub(m,e)),abs(sub(m,r)),abs(sub(m,i)),abs(sub(m,a))),p=0,h=.25,f=1,d=complex(0);;){var b=sqrt(o),x=sqrt(n),v=sqrt(s),M=sqrt(l),g=add(mul(b,x),mul(b,v),mul(x,v)),C=mul(add(Am,g),h);o=mul(add(o,g),h),n=mul(add(n,g),h),s=mul(add(s,g),h),l=mul(add(l,g),h);var w=mul(add(M,b),add(M,x),add(M,v)),y=mul(u,Math.pow(4,-3*p),inv(w),inv(w));if(f*c<abs(Am))break;d=add(d,mul(carlsonRC(1,add(1,y)),f,inv(w))),f*=h,p+=1,Am=C}var q=div(Math.pow(2,-2*p),Am),A=div(add(F=mul(sub(m,e),q),R=mul(sub(m,r),q),J=mul(sub(m,i),q)),-2),I=add(mul(F,R),mul(F,J),mul(R,J),mul(-3,A,A)),j=add(mul(F,R,J),mul(2,I,A),mul(4,A,A,A)),N=mul(add(mul(2,F,R,J),mul(I,A),mul(3,A,A,A)),A),T=mul(F,R,J,A,A);return A=add(24024,mul(-5148,I),mul(2457,I,I),mul(4004,j),mul(-4158,I,j),mul(-3276,N),mul(2772,T)),add(mul(h**p,pow(Am,-1.5),A,1/24024),mul(6,d))}for(o=e,n=r,s=i,l=a,m=Am=(e+r+i+2*a)/5,u=(a-e)*(a-r)*(a-i),c=Math.pow(.25*t,-1/6)*Math.max(Math.abs(m-e),Math.abs(m-r),Math.abs(m-i),Math.abs(m-a)),p=0,h=.25,f=1,d=0;;){b=Math.sqrt(o),x=Math.sqrt(n),v=Math.sqrt(s),M=Math.sqrt(l),g=b*x+b*v+x*v,C=(Am+g)*h;o=(o+g)*h,n=(n+g)*h,s=(s+g)*h,l=(l+g)*h;w=(M+b)*(M+x)*(M+v),y=u*Math.pow(4,-3*p)/w**2;if(f*c<Math.abs(Am))break;d+=carlsonRC(1,1+y)*f/w,f*=h,p+=1,Am=C}var F,R,J;return A=24024-5148*(I=(F=(m-e)*(q=Math.pow(2,-2*p)/Am))*(R=(m-r)*q)+F*(J=(m-i)*q)+R*J-3*(A=(-F-R-J)/2)**2)+2457*I**2+4004*(j=F*R*J+2*I*A+4*A**3)-4158*I*j-3276*(N=(2*F*R*J+I*A+3*A**3)*A)+2772*(T=F*R*J*A**2),h**p*Math.pow(Am,-1.5)*A/24024+6*d}function ellipticF(e,r){if(1===arguments.length&&(r=e,e=pi/2),isComplex(e)||isComplex(r)){isComplex(e)||(e=complex(e));var i=complex(0);if(Math.abs(e.re)>pi/2){var a=Math.round(e.re/pi);e.re=e.re-a*pi,i=mul(2*a,ellipticK(r))}return add(mul(sin(e),carlsonRF(mul(cos(e),cos(e)),sub(1,mul(r,sin(e),sin(e))),1)),i)}if(r>1&&e>Math.asin(1/Math.sqrt(r)))return ellipticF(complex(e),r);i=0;return Math.abs(e)>pi/2&&(e-=(a=Math.round(e/pi))*pi,i=2*a*ellipticK(r)),sin(e)*carlsonRF(cos(e)**2,1-r*sin(e)**2,1)+i}function ellipticK(e){return ellipticF(e)}function ellipticE(e,r){if(1===arguments.length&&(r=e,e=pi/2),isComplex(e)||isComplex(r)){isComplex(e)||(e=complex(e));var i=complex(0);if(Math.abs(e.re)>pi/2){var a=Math.round(e.re/pi);e.re=e.re-a*pi,i=mul(2*a,ellipticE(r))}return add(mul(sin(e),carlsonRF(mul(cos(e),cos(e)),sub(1,mul(r,sin(e),sin(e))),1)),mul(-1/3,r,pow(sin(e),3),carlsonRD(mul(cos(e),cos(e)),sub(1,mul(r,sin(e),sin(e))),1)),i)}if(r>1&&e>Math.asin(1/Math.sqrt(r)))return ellipticE(complex(e),r);i=0;return Math.abs(e)>pi/2&&(e-=(a=Math.round(e/pi))*pi,i=2*a*ellipticE(r)),sin(e)*carlsonRF(cos(e)**2,1-r*sin(e)**2,1)-r/3*sin(e)**3*carlsonRD(cos(e)**2,1-r*sin(e)**2,1)+i}function ellipticPi(e,r,i){if(2===arguments.length&&(i=r,r=pi/2),isComplex(e)||isComplex(r)||isComplex(i)){isComplex(r)||(r=complex(r));var a=complex(0);if(Math.abs(r.re)>pi/2){var t=Math.round(r.re/pi);r.re=r.re-t*pi,a=mul(2*t,ellipticPi(e,i))}return add(mul(sin(r),carlsonRF(mul(cos(r),cos(r)),sub(1,mul(i,sin(r),sin(r))),1)),mul(1/3,e,pow(sin(r),3),carlsonRJ(mul(cos(r),cos(r)),sub(1,mul(i,sin(r),sin(r))),1,sub(1,mul(e,sin(r),sin(r))))),a)}if(e>1&&r>Math.asin(1/Math.sqrt(e)))return ellipticPi(e,complex(r),i);if(i>1&&r>Math.asin(1/Math.sqrt(i)))return ellipticPi(e,complex(r),i);a=0;return Math.abs(r)>pi/2&&(r-=(t=Math.round(r/pi))*pi,a=2*t*ellipticPi(e,i)),sin(r)*carlsonRF(cos(r)**2,1-i*sin(r)**2,1)+e/3*sin(r)**3*carlsonRJ(cos(r)**2,1-i*sin(r)**2,1,1-e*sin(r)**2)+a}function jacobiZeta(e,r){return sub(ellipticE(e,r),mul(ellipticF(e,r),ellipticE(r),inv(ellipticK(r))))}function factorial(e){if(Number.isInteger(e)&&e>=0){for(var r=1,i=2;i<=e;i++)r*=i;return r}return isComplex(e)?gamma(add(e,1)):gamma(e+1)}function factorial2(e){if(Number.isInteger(e)&&e>0){for(var r=1&e?1:2,i=r+2;i<=e;i+=2)r*=i;return r}return Number.isInteger(e)&&0===e?1:mul(pow(2,div(e,2)),pow(pi/2,div(sub(cos(mul(pi,e)),1),4)),gamma(add(div(e,2),1)))}function binomial(e,r){return Number.isInteger(r)&&r<0&&e>=0?0:Number.isInteger(e)&&Number.isInteger(r)&&e>=0&&r>e?0:isComplex(e)||isComplex(r)?div(factorial(e),mul(factorial(sub(e,r)),factorial(r))):factorial(e)/factorial(e-r)/factorial(r)}function logGamma(e){var r=[57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22];if(isComplex(e)){if(Number.isInteger(e.re)&&e.re<=0&&0===e.im)throw"Gamma function pole";if(e.re<0){var i=sub(log(div(pi,sin(mul(pi,e)))),logGamma(sub(1,e))),a=e.im<0?-1:1,t=0===e.im?.25:0;return add(i,complex(0,2*a*Math.ceil(e.re/2-.75+t)*pi))}var i=add(e,5.2421875);i=sub(mul(add(e,.5),log(i)),i);a=.9999999999999971;for(var o=0;o<14;o++)a=add(a,div(r[o],add(e,o+1)));var n=add(i,log(mul(2.5066282746310007,div(a,e))));return a.re<0&&(e.im<0&&div(a,e).im<0&&(n=add(n,complex(0,2*pi))),e.im>0&&div(a,e).im>0&&(n=add(n,complex(0,-2*pi)))),n}if(Number.isInteger(e)&&e<=0)throw"Gamma function pole";i=(e+.5)*log(i=e+5.2421875)-i;for(a=.9999999999999971,o=0;o<14;o++)a+=r[o]/(e+o+1);return i+log(2.5066282746310007*a/e)}function gamma(e){return!isComplex(e)&&e<0?exp(logGamma(complex(e))).re:exp(logGamma(e))}function beta(e,r){return div(mul(gamma(e),gamma(r)),gamma(add(e,r)))}function hypergeometric0F1(e,r,i=1e-10){if(isComplex(e)||isComplex(r)){if(isComplex(e)||(e=complex(e)),isComplex(r)||(r=complex(r)),Number.isInteger(e.re)&&e.re<=0&&0===e.im)throw"Hypergeometric function pole";if(abs(r)>100){var a=sub(mul(2,e),1),t=(e=sub(e,.5),r=mul(4,sqrt(r)),div(mul(gamma(a),pow(mul(-1,r),mul(-1,e))),gamma(sub(a,e))));t=mul(t,hypergeometric2F0(e,add(sub(e,a),1),div(-1,r)));var o=div(mul(gamma(a),mul(pow(r,sub(e,a)),exp(r))),gamma(e));return o=mul(o,hypergeometric2F0(sub(a,e),sub(1,e),div(1,r))),mul(exp(div(r,-2)),add(t,o))}for(var n=complex(1),s=complex(1),l=1;Math.abs(s.re)>i||Math.abs(s.im)>i;)n=add(n,s=mul(s,div(div(r,e),l))),e=add(e,1),l++;return n}if(Number.isInteger(e)&&e<=0)throw"Hypergeometric function pole";if(Math.abs(r)>100)return hypergeometric0F1(e,complex(r)).re;for(n=1,s=1,l=1;Math.abs(s)>i;)n+=s*=r/e/l,e++,l++;return n}function hypergeometric1F1(e,r,i,a=1e-10){if(isComplex(e)||isComplex(r)||isComplex(i)){if(isComplex(e)||(e=complex(e)),isComplex(r)||(r=complex(r)),isComplex(i)||(i=complex(i)),Number.isInteger(r.re)&&r.re<=0&&0===r.im)throw"Hypergeometric function pole";if(i.re<0)return mul(exp(i),hypergeometric1F1(sub(r,e),r,mul(i,-1)));if(abs(i)>30){var t=div(mul(gamma(r),pow(mul(-1,i),mul(-1,e))),gamma(sub(r,e)));t=mul(t,hypergeometric2F0(e,add(sub(e,r),1),div(-1,i)));var o=div(mul(gamma(r),mul(pow(i,sub(e,r)),exp(i))),gamma(e));return add(t,o=mul(o,hypergeometric2F0(sub(r,e),sub(1,e),div(1,i))))}for(var n=complex(1),s=complex(1),l=1;Math.abs(s.re)>a||Math.abs(s.im)>a;)n=add(n,s=mul(s,div(div(mul(i,e),r),l))),e=add(e,1),r=add(r,1),l++;return n}if(Number.isInteger(r)&&r<=0)throw"Hypergeometric function pole";if(i<0)return exp(i)*hypergeometric1F1(r-e,r,-i);if(Math.abs(i)>30)return hypergeometric1F1(e,r,complex(i)).re;for(n=1,s=1,l=1;Math.abs(s)>a;)n+=s*=i*e/r/l,e++,r++,l++;return n}function hypergeometric2F0(e,r,i,a=1e-10){if(isComplex(e)||isComplex(r)||isComplex(i)){isComplex(e)||(e=complex(e)),isComplex(r)||(r=complex(r)),isComplex(i)||(i=complex(i));for(var t=complex(1),o=l=complex(1),n=!1,s=1;(Math.abs(l.re)>a||Math.abs(l.im)>a)&&!(abs(l=mul(l,div(mul(mul(i,e),r),s)))>abs(o)&&n);){if(abs(l)<abs(o)&&(n=!0),s>50)throw"Not converging after 50 terms";t=add(t,l),e=add(e,1),r=add(r,1),s++,o=l}return t}var l;for(t=1,o=l=1,n=!1,s=1;Math.abs(l)>a&&(l*=i*e*r/s,!(Math.abs(l)>Math.abs(o)&&n));){if(Math.abs(l)<Math.abs(o)&&(n=!0),s>50)throw"Not converging after 50 terms";t+=l,e++,r++,s++,o=l}return t}function hypergeometric2F1(e,r,i,a,t=1e-10){if(abs(a)>1)throw"Not yet implemented";if(isComplex(e)||isComplex(r)||isComplex(i)||isComplex(a)){if(isComplex(e)||(e=complex(e)),isComplex(r)||(r=complex(r)),isComplex(i)||(i=complex(i)),isComplex(a)||(a=complex(a)),Number.isInteger(i.re)&&i.re<=0&&0===i.im)throw"Hypergeometric function pole";for(var o=complex(1),n=complex(1),s=1;Math.abs(n.re)>t||Math.abs(n.im)>t;)o=add(o,n=mul(n,div(div(mul(mul(a,e),r),i),s))),e=add(e,1),r=add(r,1),i=add(i,1),s++;return o}if(Number.isInteger(i)&&i<=0)throw"Hypergeometric function pole";if(1===a)return gamma(i)*gamma(i-e-r)/gamma(i-e)/gamma(i-r);for(o=1,n=1,s=1;Math.abs(n)>t;)o+=n*=a*e*r/i/s,e++,r++,i++,s++;return o}function exp(e){return isComplex(e)?{re:Math.exp(e.re)*Math.cos(e.im),im:Math.exp(e.re)*Math.sin(e.im)}:Math.exp(e)}function log(e,r){return isComplex(e)?isComplex(r)?div(log(e),log(r)):{re:log(abs(e),r),im:log(Math.E,r)*arg(e)}:e<0?log(complex(e),r):void 0===r?Math.log(e):Math.log(e)/Math.log(r)}var ln=log;function lambertW(e,r){if(1===arguments.length&&(r=e,e=0),Math.abs(r+Math.exp(-1))<1e-16)return-1;switch(e){case 0:if(r<-Math.exp(-1))throw"Unsupported lambertW argument";return findRoot(e=>e*Math.exp(e)-r,[-1,1e3],{tolerance:1e-16});case-1:if(r<-Math.exp(-1)||r>0)throw"Unsupported lambertW argument";return findRoot(e=>e*Math.exp(e)-r,[-1e3,-1],{tolerance:1e-16});default:throw"Unsupported lambertW index"}}function chop(e,r=1e-10){if(Array.isArray(e)){for(var i=vector(e.length),a=0;a<e.length;a++)i[a]=chop(e[a]);return i}return isComplex(e)?{re:chop(e.re),im:chop(e.im)}:(Math.abs(e)<r&&(e=0),e)}function kronecker(e,r){return e===r?1:0}function hermite(e,r){function i(e){var r,i,a=[1],t=[2,0];if(0===e)return a;if(1===e)return t;for(var o=2;o<=e;o++){i=[],(r=t.slice()).push(0),a.unshift(0,0);for(var n=0;n<r.length;n++)i.push(2*r[n]-2*(o-1)*a[n]);a=t,t=i}return i}if(isComplex(e)||isComplex(r)){if(isComplex(e)||(e=complex(e)),Number.isInteger(e.re)&&e.re>=0&&0===e.im)return polynomial(r,i(e.re));var a=div(e,-2),t=div(sub(1,e),2),o=sub(div(hypergeometric1F1(a,.5,pow(r,2)),gamma(t)),mul(2,r,div(hypergeometric1F1(t,1.5,pow(r,2)),gamma(a))));return mul(pow(2,e),sqrt(pi),o)}if(Number.isInteger(e)&&e>=0)return polynomial(r,i(e));o=hypergeometric1F1(-e/2,.5,r**2)/gamma((1-e)/2)-2*r*hypergeometric1F1((1-e)/2,1.5,r**2)/gamma(-e/2);return 2**e*sqrt(pi)*o}function laguerre(e,r,i){return arguments.length<3&&(i=r,r=0),mul(binomial(add(e,r),e),hypergeometric1F1(neg(e),add(r,1),i))}function chebyshevT(e,r){return cos(mul(e,arccos(r)))}function chebyshevU(e,r){return div(sin(mul(add(e,1),arccos(r))),sin(arccos(r)))}function legendreP(e,r,i,a=!1){if(arguments.length<3&&(i=r,r=0),Number.isInteger(e)&&Number.isInteger(r)&&Math.abs(i)<=1){var t=Math.abs(r);if(t>e)throw"Invalid spherical harmonic indices";if(!a){for(var o=1,n=e-r+1;n<=e+r;n++)o*=n;o=Math.sqrt(4*pi*o/(2*e+1))}var s=(-1)**t*Math.sqrt((2*t+1)/4/pi/factorial(2*t))*factorial2(2*t-1)*(1-i*i)**(t/2);if(t===e)return a?s:o*s;var l=t+1,m=Math.sqrt(2*t+3),u=m*i*s;if(l===e)return a?u:o*u;for(;l<e;){l++;var c=Math.sqrt((4*l*l-1)/(l*l-t*t)),p=c*(i*u-s/m);s=u,u=p,m=c}return a?p:o*p}return mul(inv(gamma(sub(1,r))),pow(add(1,i),div(r,2)),pow(sub(1,i),div(r,-2)),hypergeometric2F1(neg(e),add(e,1),sub(1,r),div(sub(1,i),2)))}function sphericalHarmonic(e,r,i,a){var t=legendreP(e,r,cos(i),!0);return mul(Math.sign(r)**r,t,exp(complex(0,r*a)))}function sin(e){return isComplex(e)?{re:Math.sin(e.re)*Math.cosh(e.im),im:Math.cos(e.re)*Math.sinh(e.im)}:Math.sin(e)}function cos(e){return isComplex(e)?{re:Math.cos(e.re)*Math.cosh(e.im),im:-Math.sin(e.re)*Math.sinh(e.im)}:Math.cos(e)}function tan(e){return isComplex(e)?div(sin(e),cos(e)):Math.tan(e)}function cot(e){return isComplex(e)?div(cos(e),sin(e)):1/Math.tan(e)}function sec(e){return isComplex(e)?div(1,cos(e)):1/Math.cos(e)}function csc(e){return isComplex(e)?div(1,sin(e)):1/Math.sin(e)}function arcsin(e){if(isComplex(e)){var r=sqrt(sub(1,mul(e,e)));return r=add(mul(complex(0,1),e),r),mul(complex(0,-1),log(r))}return Math.abs(e)<=1?Math.asin(e):arcsin(complex(e))}function arccos(e){return isComplex(e)?sub(pi/2,arcsin(e)):Math.abs(e)<=1?Math.acos(e):arccos(complex(e))}function arctan(e){if(isComplex(e)){var r=sub(log(sub(1,mul(complex(0,1),e))),log(add(1,mul(complex(0,1),e))));return mul(complex(0,.5),r)}return Math.atan(e)}function arccot(e){return isComplex(e)?arctan(div(1,e)):Math.atan(1/e)}function arcsec(e){return isComplex(e)?arccos(div(1,e)):Math.abs(e)>=1?Math.acos(1/e):arcsec(complex(e))}function arccsc(e){return isComplex(e)?arcsin(div(1,e)):Math.abs(e)>=1?Math.asin(1/e):arccsc(complex(e))}function sinh(e){return isComplex(e)?{re:Math.sinh(e.re)*Math.cos(e.im),im:Math.cosh(e.re)*Math.sin(e.im)}:Math.sinh(e)}function cosh(e){return isComplex(e)?{re:Math.cosh(e.re)*Math.cos(e.im),im:Math.sinh(e.re)*Math.sin(e.im)}:Math.cosh(e)}function tanh(e){return isComplex(e)?div(sinh(e),cosh(e)):Math.tanh(e)}function coth(e){return isComplex(e)?div(cosh(e),sinh(e)):1/Math.tanh(e)}function sech(e){return isComplex(e)?div(1,cosh(e)):1/Math.cosh(e)}function csch(e){return isComplex(e)?div(1,sinh(e)):1/Math.sinh(e)}function arcsinh(e){if(isComplex(e)){var r=sqrt(add(mul(e,e),1));return log(r=add(e,r))}return Math.asinh(e)}function arccosh(e){if(isComplex(e)){var r=mul(sqrt(add(e,1)),sqrt(sub(e,1)));return log(r=add(e,r))}return e>=1?Math.acosh(e):arccosh(complex(e))}function arctanh(e){return isComplex(e)?mul(.5,sub(log(add(1,e)),log(sub(1,e)))):Math.abs(e)<=1?Math.atanh(e):arctanh(complex(e))}function arccoth(e){if(isComplex(e)){if(0===e.re&&0===e.im)throw"Indeterminate value";return arctanh(div(1,e))}return Math.abs(e)>1?Math.atanh(1/e):arccoth(complex(e))}function arcsech(e){if(isComplex(e)){if(0===e.re&&0===e.im)throw"Indeterminate value";return 0===e.im&&(e.im=-1e-300),arccosh(div(1,e))}return e>0&&e<1?Math.acosh(1/e):arcsech(complex(e))}function arccsch(e){return isComplex(e)?arcsinh(div(1,e)):Math.asinh(1/e)}function zeta(e){var r=14;function i(e){for(var i=0,a=0;a<=e;a++)i+=4**a*factorial(r+a-1)/factorial(r-a)/factorial(2*a);return r*i}if(isComplex(e)){if(e.re<0)return mul(pow(2,e),pow(pi,sub(e,1)),sin(mul(pi/2,e)),gamma(sub(1,e)),zeta(sub(1,e)));for(var a=complex(0),t=0;t<r;t++)a=add(a,div((-1)**t*(i(t)-i(r)),pow(t+1,e)));return div(div(a,-i(r)),sub(1,pow(2,sub(1,e))))}if(e<0)return 2**e*pi**(e-1)*sin(pi*e/2)*gamma(1-e)*zeta(1-e);for(a=0,t=0;t<r;t++)a+=(-1)**t*(i(t)-i(r))/(t+1)**e;return-a/i(r)/(1-2**(1-e))}function dirichletEta(e){return mul(zeta(e),sub(1,pow(2,sub(1,e))))}function ode(e,r,[i,a],t=.001,o="runge-kutta"){void 0===e(i,r)[0]&&(g=e,e=function(e,r){return[g(e,r)]},r=[r]);var n=[[i].concat(r)],s=r.length;switch(o){case"euler":for(var l=i+t;l<=a;l+=t){for(var m=e(l,r),u=0;u<s;u++)r[u]+=m[u]*t;n.push([l].concat(r))}return n;case"runge-kutta":for(l=i+t;l<=a;l+=t){var c=[],p=[],h=[],f=e(l,r);for(u=0;u<s;u++)c.push(r[u]+f[u]*t/2);var d=e(l+t/2,c);for(u=0;u<s;u++)p.push(r[u]+d[u]*t/2);var b=e(l+t/2,p);for(u=0;u<s;u++)h.push(r[u]+b[u]*t);var x=e(l+t,h);for(u=0;u<s;u++)r[u]+=(f[u]+2*d[u]+2*b[u]+x[u])*t/6;n.push([l].concat(r))}return n;default:throw"Unsupported method"}}function diff(e,r,i=1,a="ridders"){if(isComplex(r)){if(!isComplex(e(r)))throw"Function must handle complex math";function t(e){return mul(r,e)}return div(complex(diff(r=>e(t(r)).re,1,i,a),diff(r=>e(t(r)).im,1,i,a)),r)}function o(){for(var a=0,t=0;t<=i;t++)a+=(-1)**t*binomial(i,t)*e(r+(i-2*t)*n);return a/(2*n)**i}switch(a){case"naive":var n=1e-8**(1/(i+2));return o();case"ridders":n=1e-5**(1/(i+2));for(var s,l=Number.MAX_VALUE,m=[],u=0;u<10;u++)m.push([]);m[0][0]=o();for(u=1;u<10;u++){n/=2,m[0][u]=o();for(var c=1;c<=u;c++){m[c][u]=(4**c*m[c-1][u]-m[c-1][u-1])/(4**c-1);var p=Math.max(Math.abs(m[c][u]-m[c-1][u]),Math.abs(m[c][u]-m[c-1][u-1]));p<=l&&(l=p,s=m[c][u])}if(Math.abs(m[u][u]-m[u-1][u-1])>l)break}return s;default:throw"Unsupported method"}}var D=diff;function integrate(e,r,i="adaptive-simpson"){var a=r[0],t=r[1];if(isComplex(a)||isComplex(t)){if(isComplex(a)||(a=complex(a)),isComplex(t)||(t=complex(t)),!isComplex(e(a))||!isComplex(e(t)))throw"Function must handle complex math";function o(e){return add(mul(sub(t,a),e),a)}var n=integrate(r=>e(o(r)).re,[0,1],i),s=integrate(r=>e(o(r)).im,[0,1],i);return mul(sub(t,a),complex(n,s))}function l(){for(var r=a+(c/=2);r<t;)p+=e(r),r+=2*c}switch(i){case"euler-maclaurin":for(var m=1e-10,u=50,c=(t-a)/2,p=(e(a)+e(t))/2+e((a+t)/2),h=b=c*p,f=0;f<u;f++){if(l(),b=c*p,Math.abs(b-h)<m*Math.abs(h))return b;h=b}throw"Maximum interations reached";case"romberg":var d=Number.MAX_VALUE,b=(u=30,c=(t-a)/2,p=(e(a)+e(t))/2+e((a+t)/2),c*p),x=[];for(f=0;f<u;f++)x.push([]);x[0][0]=b;for(f=1;f<u;f++){l(),x[0][f]=c*p;for(var v=1;v<=f;v++){x[v][f]=(4**v*x[v-1][f]-x[v-1][f-1])/(4**v-1),(Y=Math.max(Math.abs(x[v][f]-x[v-1][f]),Math.abs(x[v][f]-x[v-1][f-1])))<=d&&(d=Y,b=x[v][f])}if(Math.abs(x[f][f]-x[f-1][f-1])>d)break}return b;case"adaptive-simpson":m=1e-8,u=50;var M=e(a),g=e((a+t)/2),C=e(a);return function r(i,a,t,o,n,s,l,m){var c=a-i,p=e(i+c/4),h=e(a-c/4);if(isNaN(p)||isNaN(h))throw"NaN encountered in integration";var f=(t+4*p+o)*c/12,d=(o+4*h+n)*c/12,b=f+d,x=(b-s)/15;if(Math.abs(x)<l||m>u)return b+x;var v=i+c/2;return r(i,v,t,p,o,f,l/2,m+1)+r(v,a,o,h,n,d,l/2,m+1)}(a,t,M,g,C,p=(M+4*g+C)*(t-a)/6,m,0);case"tanh-sinh":for(var w=1e-15,y=(c=1/2**(R=10),[]),q=[],A=0;A<=20*2**R;A++){var I=A*c;if(y[A]=Math.tanh(Math.PI/2*Math.sinh(I)),q[A]=Math.PI/2*Math.cosh(I)/Math.cosh(Math.PI/2*Math.sinh(I))**2,Math.abs(1-y[A])<w)break}var j=A,N=0,T=(t-a)/2,F=(t+a)/2;for(A=1;A<=R;A++)for(f=0;f<j;f+=2**(R-A))f%2**(R-A+1)==0&&1!==A||(N+=0===f?q[0]*e(F):q[f]*(e(F-T*y[f])+e(F+T*y[f])));return T*c*N;case"gaussian":w=1e-15,y=[],q=[];var R,J=3*2**(R=10);for(v=1;v<=J/2;v++){for(var K=Math.cos(Math.PI*(v-.25)/(J+.5));;){for(var P=1,U=0,k=1;k<=J;k++)t3=U,P=((2*k-1)*K*(U=P)-(k-1)*t3)/k;var Y,E=J*(K*P-U)/(K**2-1);if(K-=Y=P/E,Math.abs(Y)<w)break}y[v]=K,q[v]=2/(1-K**2)/E**2}for(T=(t-a)/2,F=(t+a)/2,N=0,v=1;v<=J/2;v++)N+=q[v]*(e(F-T*y[v])+e(F+T*y[v]));return T*N;default:throw"Unsupported method"}}function discreteIntegral(e,r){for(var i=(e[0]+e[e.length-1])/2,a=1;a<e.length-1;a++)i+=e[a];return i*r}function polynomial(e,r,i=!1){for(var a=r[0],t=0,o=1;o<r.length;o++)i&&(t=add(a,mul(t,e))),a=add(r[o],mul(a,e));return i?{polynomial:a,derivative:t}:a}function partialBell(e,r,arguments){if(0===e&&0===r)return 1;if(0===e||0===r)return 0;for(var i=0,a=1,t=1;t<=e-r+1;t++)i+=a*arguments[t-1]*partialBell(e-t,r-1,arguments),a*=(e-t)/t;return i}function findRoot(e,r,i={}){Array.isArray(r)||i.method||(i.method="newton");var a="method"in i?i.method:"bisect",t="tolerance"in i?i.tolerance:1e-10;switch(a){case"bisect":var o,n=r[0],s=r[1],l=e(n);e(s);if(l*e(s)>=0)throw"Change of sign necessary for bisection";l<0?(p=n,o=s-n):(p=s,o=n-s);for(var m=100,u=0;u<m;u++){var c=p+(o/=2);if(fmid=e(c),fmid<=0&&(p=c),0===fmid||Math.abs(o)<t)return p}throw"No root found for tolerance "+t;case"newton":var p;m=100;if(isComplex(p=r))for(u=0;u<m;u++){if(p=sub(p,h=div(e(p),diff(e,p))),abs(h)<t)return p}else for(u=0;u<m;u++){var h;if(p-=h=e(p)/diff(e,p),Math.abs(h)<t)return p}throw"No root found for tolerance "+t;default:throw"Unsupported method"}}function spline(e,r="function"){for(var i=[],a=[],t=[],o=[],n=0;n<e.length;n++)i[n]=e[n][1];t[0]=0,t[e.length-1]=0;var s=matrix(e.length-2),l=vector(e.length-2);function m(r){return e[r+1][0]-e[r][0]}for(n=0;n<s.length;n++)s[n][n]=2*(m(n)+m(n+1)),l[n]=3*(i[n+2]-i[n+1])/m(n+1)-3*(i[n+1]-i[n])/m(n);for(n=1;n<s.length;n++)s[n][n-1]=m(n),s[n-1][n]=m(n);var u=luSolve(s,l);for(n=0;n<u.length;n++)t[n+1]=u[n];for(n=0;n<t.length-1;n++)a[n]=(i[n+1]-i[n])/m(n)-(t[n+1]+2*t[n])*m(n)/3,o[n]=(t[n+1]-t[n])/3/m(n);switch(r){case"function":return function(r){for(var n=0;n<e.length;n++)if(r===e[n][0])return i[n];for(n=0;n<e.length-1;n++)if(r>e[n][0]&&r<e[n+1][0]){var s=e[n][0];return i[n]+a[n]*(r-s)+t[n]*(r-s)**2+o[n]*(r-s)**3}};case"derivative":return function(r){for(var i=0;i<e.length;i++)if(r===e[i][0])return a[i];for(i=0;i<e.length-1;i++)if(r>e[i][0]&&r<e[i+1][0]){var n=e[i][0];return a[i]+2*t[i]*(r-n)+3*o[i]*(r-n)**2}};case"integral":return function(r){var n=0;function s(r,n){var s=e[n][0];return i[n]*(r-s)+a[n]*(r-s)**2/2+t[n]*(r-s)**3/3+o[n]*(r-s)**4/4}for(var l=0;l<e.length-1;l++){if(r<e[l+1][0]){n+=s(r,l)-s(e[l][0],l);break}n+=s(e[l+1][0],l)-s(e[l][0],l)}return n};default:throw"Unsupported value"}}function eigensystem(e,r=!0){if(r)return tridiagonalQL(tridiagonalForm(e));throw"Unsupported system"}function tridiagonalForm(e){for(var r=e.length,i=[],a=0;a<r;a++)i[a]=e[a].slice();for(var t=vector(r),o=vector(r),n=0;n<r;n++)t[n]=i[r-1][n];for(a=r-1;a>0;a--){for(var s=0,l=0,m=0;m<a;m++)s+=Math.abs(t[m]);if(0===s){o[a]=t[a-1];for(n=0;n<a;n++)t[n]=i[a-1][n],i[a][n]=0,i[n][a]=0}else{for(m=0;m<a;m++)t[m]/=s,l+=t[m]*t[m];var u=t[a-1],c=Math.sqrt(l);u>0&&(c=-c),o[a]=s*c,l-=u*c,t[a-1]=u-c;for(n=0;n<a;n++)o[n]=0;for(n=0;n<a;n++){u=t[n],i[n][a]=u,c=o[n]+i[n][n]*u;for(m=n+1;m<=a-1;m++)c+=i[m][n]*t[m],o[m]+=i[m][n]*u;o[n]=c}u=0;for(n=0;n<a;n++)o[n]/=l,u+=o[n]*t[n];var p=u/(l+l);for(n=0;n<a;n++)o[n]-=p*t[n];for(n=0;n<a;n++){u=t[n],c=o[n];for(m=n;m<=a-1;m++)i[m][n]-=u*o[m]+c*t[m];t[n]=i[a-1][n],i[a][n]=0}}t[a]=l}for(a=0;a<r-1;a++){if(i[r-1][a]=i[a][a],i[a][a]=1,0!==(l=t[a+1])){for(m=0;m<=a;m++)t[m]=i[m][a+1]/l;for(n=0;n<=a;n++){for(c=0,m=0;m<=a;m++)c+=i[m][a+1]*i[m][n];for(m=0;m<=a;m++)i[m][n]-=c*t[m]}}for(m=0;m<=a;m++)i[m][a+1]=0}for(n=0;n<r;n++)t[n]=i[r-1][n],i[r-1][n]=0;return i[r-1][r-1]=1,o[0]=0,{diagonal:t,offDiagonal:o,eigenvectors:i}}function tridiagonalQL(e){var r=e.diagonal,i=r.length,a=e.offDiagonal,t=e.eigenvectors;function o(e,r){var i;return Math.abs(e)>Math.abs(r)?(i=r/e,i=Math.abs(e)*Math.sqrt(1+i*i)):0!=r?(i=e/r,i=Math.abs(r)*Math.sqrt(1+i*i)):i=0,i}for(var n=1;n<i;n++)a[n-1]=a[n];a[i-1]=0;for(var s=0,l=0,m=Math.pow(2,-52),u=0;u<i;u++){l=Math.max(l,Math.abs(r[u])+Math.abs(a[u]));for(var c=u;c<i&&!(Math.abs(a[c])<=m*l);)c++;if(c>u){var p=0;do{if((p+=1)>1e3)throw"Eigenvalues not converging...";var h=r[u],f=o(q=(r[u+1]-h)/(2*a[u]),1);q<0&&(f=-f),r[u]=a[u]/(q+f),r[u+1]=a[u]*(q+f);var d=r[u+1],b=h-r[u];for(n=u+2;n<i;n++)r[n]-=b;s+=b,q=r[c];var x=1,v=x,M=x,g=a[u+1],C=0,w=0;for(n=c-1;n>=u;n--){M=v,v=x,w=C,h=x*a[n],b=x*q,f=o(q,a[n]),a[n+1]=C*f,C=a[n]/f,q=(x=q/f)*r[n]-C*h,r[n+1]=b+C*(x*h+C*r[n]);for(var y=0;y<i;y++)b=t[y][n+1],t[y][n+1]=C*t[y][n]+x*b,t[y][n]=x*t[y][n]-C*b}q=-C*w*M*g*a[u]/d,a[u]=C*q,r[u]=x*q}while(Math.abs(a[u])>m*l)}r[u]=r[u]+s,a[u]=0}for(n=0;n<i-1;n++){y=n;for(var q=r[n],A=n+1;A<i;A++)r[A]<q&&(y=A,q=r[A]);if(y!=n){r[y]=r[n],r[n]=q;for(A=0;A<i;A++)q=t[A][n],t[A][n]=t[A][y],t[A][y]=q}}return{eigenvalues:r,eigenvectors:t}}function hessenbergForm(e){}function luDecomposition(e,r=1e-7){for(var i=e.length,a=[],t=0;t<i;t++)a[t]=e[t].slice();var o=identity(i);pivots=0;for(t=0;t<i;t++){for(var n=0,s=t,l=t;l<i;l++){var m=Math.abs(a[l][t]);m>n&&(n=m,s=l)}if(n<r)throw"Matrix is degenerate";if(s!==t){var u=a[t];a[t]=a[s],a[s]=u;u=o[t];o[t]=o[s],o[s]=u,pivots++}for(l=t+1;l<i;l++){a[l][t]/=a[t][t];for(var c=t+1;c<i;c++)a[l][c]-=a[l][t]*a[t][c]}}var p=identity(i);for(t=1;t<i;t++)for(l=0;l<t;l++)p[t][l]=a[t][l];var h=matrix(i);for(t=0;t<i;t++)for(l=t;l<i;l++)h[t][l]=a[t][l];return{L:p,U:h,P:o,pivots:pivots}}function luSolve(e,r){for(var i=e.length,a=luDecomposition(e),t=vector(i),o=vector(i),n=vector(i),s=0;s<i;s++)for(var l=0;l<i;l++)n[s]+=a.P[s][l]*r[l];for(s=0;s<i;s++){o[s]=n[s];for(l=0;l<s;l++)o[s]-=a.L[s][l]*o[l];o[s]/=a.L[s][s]}for(s=i-1;s>=0;s--){t[s]=o[s];for(l=s+1;l<i;l++)t[s]-=a.U[s][l]*t[l];t[s]/=a.U[s][s]}return t}function determinant(e){for(var r=luDecomposition(e),i=1,a=0;a<e.length;a++)i*=r.U[a][a];return(-1)**r.pivots*i}function inverse(e){for(var r=matrix(e.length),i=0;i<e.length;i++){var a=vector(e.length);a[i]=1;for(var t=luSolve(e,a),o=0;o<e.length;o++)r[o][i]=t[o]}return r}function vector(e,r=0){for(var i=[],a=0;a<e;a++)i.push(r);return i}function matrix(e,r,i=0){r=r||e;for(var a=[],t=0;t<e;t++){a.push([]);for(var o=0;o<r;o++)a[t].push(i)}return a}function identity(e,r=1){for(var i=matrix(e),a=0;a<e;a++)i[a][a]=r;return i}function transpose(e){for(var r=matrix(e[0].length,e.length),i=0;i<e.length;i++)for(var a=0;a<e[0].length;a++)r[a][i]=e[i][a];return r}function matrixAdd(e,r){if(!Array.isArray(e)&&!Array.isArray(r))throw"No matrices";Array.isArray(e)||(e=matrix(r.length,r[0].length,e)),Array.isArray(r)||(r=matrix(e.length,e[0].length,r));for(var i=matrix(e.length,e[0].length,0),a=0;a<e.length;a++)for(var t=0;t<e[0].length;t++)i[a][t]=add(e[a][t],r[a][t]);return i}function matrixSub(e,r){if(!Array.isArray(e)&&!Array.isArray(r))throw"No matrices";Array.isArray(e)||(e=matrix(r.length,r[0].length,e)),Array.isArray(r)||(r=matrix(e.length,e[0].length,r));for(var i=matrix(e.length,e[0].length,0),a=0;a<e.length;a++)for(var t=0;t<e[0].length;t++)i[a][t]=sub(e[a][t],r[a][t]);return i}function matrixMul(e,r){if(!Array.isArray(e)&&!Array.isArray(r))throw"No matrices";if(Array.isArray(e)||(e=identity(r.length,e)),Array.isArray(r)||(r=identity(e[0].length,r)),e[0].length!==r.length)throw"Incompatible matrices";for(var i=matrix(e.length,r[0].length,0),a=0;a<e.length;a++)for(var t=0;t<r[0].length;t++)for(var o=0;o<e[0].length;o++)i[a][t]=add(i[a][t],mul(e[a][o],r[o][t]));return i}